

<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>netperf | Lingfei&#39;s Blog</title>
  <meta name="author" content="Lingfei Kong">
  
  <meta name="description" content="读书笔记，资料整理">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="netperf"/>
  <meta property="og:site_name" content="Lingfei&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon" type="image/x-ico">
  <link rel="alternate" href="http://kongll.github.io/atom.xml" title="Lingfei&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Ffe3814b5f53cc394a493cbeb2368f2af' type='text/javascript'%3E%3C/script%3E"));
</script>



</head>


<body>
  <header id="header" class="inner">
<div class="alignleft">
  <h1><a href="/">Lingfei&#39;s Blog</a></h1>
  <h2><a href="/">我要扼住命运的咽喉，决不能让命运使我屈服</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/categories/Technology">技术</a></li>
    
      <li><a href="/categories/essay">随笔</a></li>
    
      <li><a href="/archives">归档</a></li>
    
      <li><a href="/about">关于</a></li>
    
	<li> <a href="/atom.xml">RSS</a> </li>
<li> <a title="把这个链接拖到你的Chrome收藏夹工具栏中" href='javascript:(function() {
	function c() {
		var e = document.createElement("link");
		e.setAttribute("type", "text/css");
		e.setAttribute("rel", "stylesheet");
		e.setAttribute("href", f);
		e.setAttribute("class", l);
		document.body.appendChild(e)
	}
 
	function h() {
		var e = document.getElementsByClassName(l);
		for (var t = 0; t < e.length; t++) {
			document.body.removeChild(e[t])
		}
	}
 
	function p() {
		var e = document.createElement("div");
		e.setAttribute("class", a);
		document.body.appendChild(e);
		setTimeout(function() {
			document.body.removeChild(e)
		}, 100)
	}
 
	function d(e) {
		return {
			height : e.offsetHeight,
			width : e.offsetWidth
		}
	}
 
	function v(i) {
		var s = d(i);
		return s.height > e && s.height < n && s.width > t && s.width < r
	}
 
	function m(e) {
		var t = e;
		var n = 0;
		while (!!t) {
			n += t.offsetTop;
			t = t.offsetParent
		}
		return n
	}
 
	function g() {
		var e = document.documentElement;
		if (!!window.innerWidth) {
			return window.innerHeight
		} else if (e && !isNaN(e.clientHeight)) {
			return e.clientHeight
		}
		return 0
	}
 
	function y() {
		if (window.pageYOffset) {
			return window.pageYOffset
		}
		return Math.max(document.documentElement.scrollTop, document.body.scrollTop)
	}
 
	function E(e) {
		var t = m(e);
		return t >= w && t <= b + w
	}
 
	function S() {
		var e = document.createElement("audio");
		e.setAttribute("class", l);
		e.src = i;
		e.loop = false;
		e.addEventListener("canplay", function() {
			setTimeout(function() {
				x(k)
			}, 500);
			setTimeout(function() {
				N();
				p();
				for (var e = 0; e < O.length; e++) {
					T(O[e])
				}
			}, 15500)
		}, true);
		e.addEventListener("ended", function() {
			N();
			h()
		}, true);
		e.innerHTML = " <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";
		document.body.appendChild(e);
		e.play()
	}
 
	function x(e) {
		e.className += " " + s + " " + o
	}
 
	function T(e) {
		e.className += " " + s + " " + u[Math.floor(Math.random() * u.length)]
	}
 
	function N() {
		var e = document.getElementsByClassName(s);
		var t = new RegExp("\\b" + s + "\\b");
		for (var n = 0; n < e.length; ) {
			e[n].className = e[n].className.replace(t, "")
		}
	}
 
	var e = 30;
	var t = 30;
	var n = 350;
	var r = 350;
	var i = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3";
	var s = "mw-harlem_shake_me";
	var o = "im_first";
	var u = ["im_drunk", "im_baked", "im_trippin", "im_blown"];
	var a = "mw-strobe_light";
	var f = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css";
	var l = "mw_added_css";
	var b = g();
	var w = y();
	var C = document.getElementsByTagName("*");
	var k = null;
	for (var L = 0; L < C.length; L++) {
		var A = C[L];
		if (v(A)) {
			if (E(A)) {
				k = A;
				break
			}
		}
	}
	if (A === null) {
		console.warn("Could not find a node of the right size. Please try a different page.");
		return
	}
	c();
	S();
	var O = [];
	for (var L = 0; L < C.length; L++) {
		var A = C[L];
		if (v(A)) {
			O.push(A)
		}
	}
})()    '>High一下</a> </li>

  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-06-17T00:35:18.000Z"><a href="/2015/06/17/netperf/">2015-06-17</a></time>
      
      
  
    <h1 class="title">netperf</h1>
  

    </header>
    <div class="entry">
      
        <h1 id="How_to_install_netperf">How to install netperf</h1><ol>
<li><p>Download netperf from ftp://ftp.netperf.org/netperf/netperf-2.6.0.tar.gz</p>
</li>
<li><p>Install netperf from source code</p>
</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar -xvzf netperf-xxxxx</span></span><br><span class="line"><span class="comment"># cd netperf-xxxxx</span></span><br><span class="line"><span class="comment"># ./configure --enable-burst</span></span><br><span class="line"><span class="comment"># make</span></span><br><span class="line"><span class="comment"># make install</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h1 id="Features_and_Functions">Features and Functions</h1><p>Netperf is designed around a basic client-server model. There are two executables - netperf and netserver. Generally you will only execute the netperf program, with the netserver program being invoked by the remote system’s inetd or having been previously started as its own standalone daemon.</p>
<p>When you execute netperf it will establish a “control connection” to the remote system. This connection will be used to pass test configuration information and results to and from the remote system. Regardless of the type of test to be run, the control connection will be a TCP connection using BSD sockets. The control connection can use either IPv4 or IPv6.</p>
<p>Once the control connection is up and the configuration information has been passed, a separate “data” connection will be opened for the measurement itself using the API’s and protocols appropriate for the specified test. When the test is completed, the data connection will be torn-down and results from the netserver will be passed-back via the control connection and combined with netperf’s result for display to the user.</p>
<p>Netperf places no traffic on the control connection while a test is in progress. Certain TCP options, such as SO_KEEPALIVE, if set as your systems’ default, may put packets out on the control connection while a test is in progress. Generally speaking this will have no effect on the results.</p>
<h1 id="How_to_use_netperf">How to use netperf</h1><p>For xen performance testing, we only test the following type of test:</p>
<ul>
<li><strong>TCP_STREAM</strong> - is the default test in netperf. It is quite simple, transferring some quantity of data from the system running netperf to the system running netserver.</li>
<li><strong>TCP_RR</strong> - A TCP_RR test can be thought-of as a user-space to user-space ping with no think time - it is by default a synchronous, one transaction at a time, request/response test.</li>
<li><strong>TCP_CRR</strong> - A TCP_CRR test is like a merger of a TCP_RR and TCP_CC test which measures the performance of establishing a connection, exchanging a single request/response transaction, and tearing-down that connection.</li>
<li><strong>UDP_STREAM</strong> - A UDP_STREAM test is similar to a TCP_STREAM test except UDP is used as the transport rather than TCP.</li>
<li><strong>UDP_RR</strong> - It is very much the same as a TCP_RR test except UDP is used rather than TCP.</li>
</ul>
<h2 id="Multiple_instances_of_TCP_STREAM">Multiple instances of TCP_STREAM</h2><h3 id="Test_scenarios">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 4</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="number">32</span> <span class="number">64</span> <span class="number">128</span> <span class="number">256</span> <span class="number">512</span> <span class="number">1024</span> <span class="number">1460</span> <span class="number">2048</span> <span class="number">4096</span> <span class="number">8192</span>  <span class="number">9000</span> <span class="number">16384</span> <span class="number">32768</span>  <span class="number">65495</span> <span class="number">65507</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        netperf -t TCP_STREAM <span class="operator">-f</span> m -H <span class="variable">$remote_server_ip</span> -P <span class="number">0</span> <span class="operator">-l</span> <span class="number">10</span> -- -m <span class="variable">$a</span> &amp;</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="Multiple_instances_of_UDP_STREAM">Multiple instances of UDP_STREAM</h2><h3 id="Test_scenarios-1">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command-1">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 4</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="number">32</span> <span class="number">64</span> <span class="number">128</span> <span class="number">256</span> <span class="number">512</span> <span class="number">1024</span> <span class="number">1460</span> <span class="number">2048</span> <span class="number">4096</span> <span class="number">8192</span>  <span class="number">9000</span> <span class="number">16384</span> <span class="number">32768</span>  <span class="number">65495</span> <span class="number">65507</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        netperf -t UDP_STREAM <span class="operator">-f</span> m -H <span class="variable">$remote_server_ip</span> -P <span class="number">0</span> <span class="operator">-l</span> <span class="number">10</span> -- -m <span class="variable">$a</span> &amp;</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="Multiple_instances_of_TCP_RR">Multiple instances of TCP_RR</h2><h3 id="Test_scenarios-2">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command-2">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 1/25/50/100</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">25</span> <span class="number">50</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    netperf -v <span class="number">0</span> -P <span class="number">0</span> -t TCP_RR -B <span class="string">": VM1 -b <span class="variable">$b</span> -r 256,256"</span> -H <span class="variable">$remote_server_ip</span> -- -r <span class="number">256</span>,<span class="number">256</span> -b <span class="variable">$b</span> -D</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="Multiple_instances_of_UDP_RR">Multiple instances of UDP_RR</h2><h3 id="Test_scenarios-3">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command-3">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 1/25/50/100</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">25</span> <span class="number">50</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    netperf -v <span class="number">0</span> -P <span class="number">0</span> -t UDP_RR -B <span class="string">": VM1 -b <span class="variable">$b</span> -r 256,256"</span> -H <span class="variable">$remote_server_ip</span> -- -r <span class="number">256</span>,<span class="number">256</span> -b <span class="variable">$b</span> -D</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="Multiple_instances_of_TCP_CRR">Multiple instances of TCP_CRR</h2><h3 id="Test_scenarios-4">Test scenarios</h3><ol>
<li>Host -&gt;External Host</li>
<li>Host -&gt; Guest</li>
<li>Guest -&gt; Host</li>
<li>Guest -&gt; Guest</li>
<li>External Host -&gt; Guest</li>
<li>Guest -&gt; External Host</li>
</ol>
<p><strong>Note:</strong><br>A straight attachment link two machine<br>For secnario 5 &amp; 6 better in 10Gbit</p>
<h3 id="Command-4">Command</h3><ol>
<li><p>Run <code>netserver</code> on remote host</p>
</li>
<li><p>On local host, run:</p>
</li>
</ol>
<p>e.g instances = 1/25/50/100</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> <span class="number">1</span> <span class="number">25</span> <span class="number">50</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    netperf -v <span class="number">0</span> -P <span class="number">0</span> -t TCP_CRR  -H <span class="variable">$remote_server_ip</span> -- -r <span class="number">256</span>,<span class="number">256</span> -b <span class="number">1</span> -D</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong> There also some example scripts used to test TCP_STREAM, TCP_RR, UDP_STREAM, UDP_RR under netperf-xxxxx/doc/examples/, you can modify it as necessary.</p>
<h1 id="Results_analysis">Results analysis</h1><h2 id="For_TCP_STREAM_test">For TCP_STREAM test</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">87380</span>  <span class="number">16384</span>     <span class="number">64</span>    <span class="number">10.00</span>     <span class="number">688.1</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>the first field</strong> - remote (netserver) send and/or receive socket buffer sizes for the data connection.</li>
<li><strong>the second field</strong> - local (netperf) send and receive socket buffer sizes for the data connection.</li>
<li><strong>the third field</strong> - the size of the buffer passed-in to the “send” calls of a _STREAM test.</li>
<li><strong>the fourth field</strong> - the  length  of  the  test (default 10 seconds).</li>
<li><strong>the fifth field</strong> - Throughput</li>
</ul>
<p>We should focus on the <strong>Throughput</strong>, the larger the better.</p>
<h2 id="For_UDP_STREAM_test">For UDP_STREAM test</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">212992</span>      <span class="number">64</span>   <span class="number">10.00</span>      <span class="number">659319</span>      <span class="number">0</span>      <span class="number">33.76</span></span><br><span class="line"><span class="number">212992</span>           <span class="number">10.00</span>      <span class="number">610884</span>             <span class="number">31.28</span></span><br></pre></td></tr></table></figure>
<p>The first line is the results of local host.<br>The second is the results of remote server.</p>
<ul>
<li><strong>the first field</strong> - remote (netserver) send and/or receive socket buffer sizes for the data connection.</li>
<li><strong>the second field</strong> - local (netperf) send and receive socket buffer sizes for the data connection.</li>
<li><strong>the third field</strong> - the size of the buffer passed-in to the “send” calls of a _STREAM test.</li>
<li><strong>the fourth field</strong> - the  length  of  the  test (default 10 seconds).</li>
<li><strong>the fifth field</strong> - Throughput</li>
</ul>
<p>We should focus on the <strong>Throughput</strong>, the larger the better.</p>
<h2 id="For_TCP_RR_test">For TCP_RR test</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">31464.49</span> : VM1 -<span class="number">25</span>  -r <span class="number">256</span>,<span class="number">256</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>the first field</strong> - Transaction rate</li>
</ul>
<p>We should focus on the <strong>Transaction rate</strong>, the larger the better.</p>
<h2 id="For_TCP_CRR">For TCP_CRR</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">151.40</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>the first field</strong> - Transaction rate</li>
</ul>
<p>We should focus on the <strong>Transaction rate</strong>, the larger the better.</p>
<h2 id="For_UDP_RR">For UDP_RR</h2><p>The results will be in the following format:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">33748.49</span> : VM1 -b  -r <span class="number">256</span>,<span class="number">256</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>the first field</strong> - Transaction rate</li>
</ul>
<p>We should focus on the <strong>Transaction rate</strong>, the larger the better.</p>
<h1 id="The_main_parameters">The main parameters</h1><p>Netperf command format:</p>
<ol>
<li><p>sets both global and test-specific options:<br><code>netperf &lt;global&gt; -- &lt;test-specific&gt;</code></p>
</li>
<li><p>sets just global options and:<br><code>netperf &lt;global&gt;</code></p>
</li>
<li><p>sets just global options and:<br><code>netperf -- &lt;test-specific&gt;</code></p>
</li>
</ol>
<h2 id="Global_Options">Global Options</h2><ul>
<li><strong>-B <string></string></strong> - This option will cause <string> to be appended to the brief (see -P) output of netperf.</string></li>
<li><strong>-H name|ip</strong> - Set the hostname (or IP address) and address family to use to establish the control connection to the remote system.</li>
<li><strong>-b <size></size></strong> - This option is only present when netperf has been configure with –enable-intervals=yes prior to compilation. It sets the size of the burst of send calls in a _STREAM test. When used in conjunction with the -w option it can cause the rate at which data is sent to be “paced.”</li>
<li><strong>-i <sizespec></sizespec></strong> - This option enables the calculation of confidence intervals and sets the minimum and maximum number of iterations to run in attempting to achieve the desired confidence interval.</li>
<li><strong>-t testname</strong> - Specify the test to perform. As of this writing, valid values for testname include:<ul>
<li><strong>TCP_STREAM</strong>, TCP_MAERTS, TCP_SENDFILE, <strong>TCP_RR</strong>, <strong>TCP_CRR</strong>, TCP_CC</li>
<li><strong>UDP_STREAM</strong>, <strong>UDP_RR</strong></li>
<li>XTI_TCP_STREAM, XTI_TCP_RR, XTI_TCP_CRR, XTI_TCP_CC</li>
<li>XTI_UDP_STREAM, XTI_UDP_RR</li>
<li>SCTP_STREAM, SCTP_RR</li>
<li>DLCO_STREAM, DLCO_RR, DLCL_STREAM, DLCL_RR</li>
<li>LOC_CPU, REM_CPU</li>
<li>OMNI</li>
</ul>
</li>
<li><strong>-l testlen</strong> - Specify  the  length  of  the  test (default 10 seconds).</li>
<li><strong>-4</strong> - Use AF_INET (aka IPv4) addressing for the control and possibly data connections.</li>
<li><strong>-6</strong> - Use AF_INET6 (aka IPv6) addressing for the control and possibly data connections.</li>
<li><strong>-v verbosity</strong> - This option controls how verbose netperf will be in its output, and is often used in conjunction with the -P option.</li>
<li><strong>-P 0|1</strong> - A value of “1” for the -P option will enable display of the test banner. A value of “0” will disable display of the test banner.</li>
</ul>
<h2 id="Test_Specific_Options(TCP_STREAM,_UDP_STREAM)">Test Specific Options(TCP_STREAM, UDP_STREAM)</h2><ul>
<li><strong>-s <sizespec></sizespec></strong> - This option sets the local (netperf) send and receive socket buffer sizes for the data connection to the value(s) specified. Often, this will affect the advertised and/or effective TCP or other window, but on some platforms it may not. By default the units are bytes, but suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-S <sizespec></sizespec></strong> - This option sets the remote (netserver) send and/or receive socket buffer sizes for the data connection to the value(s) specified. Often, this will affect the advertised and/or effective TCP or other window, but on some platforms it may not. By default the units are bytes, but suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-m bytes</strong> - Set the size of the buffer passed-in to the “send” calls of a <em>STREAM test. Note that this may have only an indirect effect on the size of the packets sent over the network, and certain Layer 4 protocols do _not</em> preserve or enforce message boundaries, so setting -m for the send size does not necessarily mean the receiver will receive that many bytes at any one time. By default the units are bytes, but suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-M bytes</strong> - Set the size of the buffer passed-in to the “recv” calls of a _STREAM test. This will be an upper bound on the number of bytes received per receive call. By default the units are bytes, but suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-D</strong> - This option will set TCP_NODELAY on the data connection on those systems where TCP_NODELAY is defined. This disables something known as the Nagle Algorithm, which is intended to make the segments TCP sends as large as reasonably possible.</li>
</ul>
<h2 id="Test_Specific_Options(TCP_RR,_TCP_CRR,_UDP_RR)">Test Specific Options(TCP_RR, TCP_CRR, UDP_RR)</h2><ul>
<li><strong>-r <sizespec></sizespec></strong> - This option sets the request (first value) and/or response (second value) sizes for an _RR test. By default the units are bytes, but a suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-s <sizespec></sizespec></strong> - This option sets the local (netperf) send and receive socket buffer sizes for the data connection to the value(s) specified. Often, this will affect the advertised and/or effective TCP or other window, but on some platforms it may not. By default the units are bytes, but a suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-S <sizespec></sizespec></strong> - This option sets the remote (netserver) send and/or receive socket buffer sizes for the data connection to the value(s) specified. Often, this will affect the advertised and/or effective TCP or other window, but on some platforms it may not. By default the units are bytes, but a suffix of “G,” “M,” or “K” will specify the units to be 2^30 (GB), 2^20 (MB) or 2^10 (KB) respectively. A suffix of “g,” “m” or “k” will specify units of 10^9, 10^6 or 10^3 bytes respectively.</li>
<li><strong>-D</strong> - This option will set TCP_NODELAY on the data connection on those systems where TCP_NODELAY is defined. This disables something known as the Nagle Algorithm, which is intended to make the segments TCP sends as large as reasonably possible.</li>
</ul>
<h1 id="Reference">Reference</h1><ul>
<li><a href="http://www.netperf.org/svn/netperf2/tags/netperf-2.6.0/doc/netperf.html" target="_blank" rel="external">netperf manual</a></li>
<li><a href="http://www.netperf.org/netperf/" target="_blank" rel="external">Welcome to the Netperf Homepage</a></li>
</ul>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/Technology/">Technology</a>
  </div>

        
<!-- Baidu Button BEGIN -->
<div id="bdshare" class="bdshare_t bds_tools_32 get-codes-bdshare">
<a class="bds_qzone"></a>
<a class="bds_tsina"></a>
<a class="bds_tqq"></a>
<a class="bds_renren"></a>
<a class="bds_t163"></a>
<span class="bds_more"></span>
<a class="shareCount"></a>
</div>
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=3326447" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
<!-- Baidu Button END -->      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">

<nav id="pagination" >
    
    <a href="/2015/06/18/My-TODO-List/" class="alignleft prev" >上一页</a>
    
    
    <a href="/2015/06/16/Performance-and-Stress-testing/" class="alignright next" >下一页</a>
    
    <div class="clearfix"></div>
</nav>

<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"孔令飞"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->  
</section>


</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:konglf.github.com">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/Technology/Emacs/">Emacs</a><small>1</small></li>
  
    <li><a href="/categories/Technology/Keys/">Keys</a><small>2</small></li>
  
    <li><a href="/categories/Technology/Lex/">Lex</a><small>2</small></li>
  
    <li><a href="/categories/Technology/Linux/">Linux</a><small>1</small></li>
  
    <li><a href="/categories/essay/Linux/">Linux</a><small>1</small></li>
  
    <li><a href="/categories/Technology/Python/">Python</a><small>2</small></li>
  
    <li><a href="/categories/Technology/Shell/">Shell</a><small>1</small></li>
  
    <li><a href="/categories/Technology/">Technology</a><small>30</small></li>
  
    <li><a href="/categories/Technology/Xen/Virtualization/">Virtualization</a><small>1</small></li>
  
    <li><a href="/categories/Technology/Xen/">Xen</a><small>1</small></li>
  
    <li><a href="/categories/essay/">essay</a><small>3</small></li>
  
  </ul>
</div>


  <div class="widget tag">
<h3 class="title">简介</h3>
<ul class="entry">
<li>中文名：孔令飞</li>
<li>英文名：Alex</li>
<li>现状：Lenovo从事存储性能优化</li>
<li>QQ号：466701708</li>
<li>想交友的朋友请<a href="http://kongll.github.io/about">联系我</a>！</li>
<li>我的<a href="http://blog.csdn.net/lnxfei">CSDN</a>博客</li>
</ul>
</div>


  <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=3768665395&verifier=bc944b64&dpc=1"></iframe>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Xen/" style="font-size: 10px;">Xen</a> <a href="/tags/emacs/" style="font-size: 20px;">emacs</a> <a href="/tags/博客技巧/" style="font-size: 10px;">博客技巧</a>
  </div>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Lingfei Kong
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>


<a href="https://github.com/alex8866" target="_blank"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_white_ffffff.png" alt="Fork me on GitHub"></a>
